main = "All Storms", ylab = "Sketching")
allSketch <- rnorm(length(trueY))
allSketch <- rnorm(length(trueY))
slowSketch <- rnorm(length(trueY))
fastSketch <- rnorm(length(trueY))
par(mfrow = c(3,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
main = "All Storms", ylab = "Sketching")
image.plot(surf, xaxs ="r", yaxs = "r", main="All Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
ylab = "Sketching")
par(mfrow = c(3,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="All Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
ylab = "Sketching")
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
ylab = "Sketching")
par(mfrow = c(3,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
ylab = "Sketching")
par(mfrow = c(3,3))
par(mfrow = c(3,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE, add = FALSE))
image.plot(surf, add=FALSE, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
par(mfrow = c(3,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
allBART <- rnorm(length(trueY))
slowBart <- rnorm(length(trueY))
fastBART <- rnorm(length(trueY))
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
slowBart <- rnorm(length(trueY))
fastBART <- rnorm(length(trueY))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
warnings()
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
plot.new()
lgd_ = rep(NA, 11)
lgd_[c(1,6,11)] = c(1,6,11)
legend(x = 0.5, y = 0.5,
legend = lgd_,
fill = colorRampPalette(colors = c('black','red3','grey96'))(11),
border = NA,
y.intersp = 0.5,
cex = 2, text.font = 2)
plot.new()
lgd_ = rep(NA, 11)
lgd_[c(1,6,11)] = c(1,6,11)
legend(x = 0.5, y = 0.5,
legend = lgd_,
fill = colorRampPalette(colors = c('black','red3','grey96'))(11),
border = NA,
y.intersp = 0.5,
cex = 2, text.font = 2)
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
color.legend(12,220,13,80,rev(ddf$VAL),rev(col.pal),gradient="y")
install.packages("plotrix")
library(plotrix)
library(plotrix)
ddf=structure(list(VAR = structure(1:9, .Label = c("aaa", "bbb", "ccc", "ddd", "eee", "fff", "ggg", "hhh", "iii"), class = "factor"),                       VAL = c(0L, 32L, 64L, 96L, 128L, 160L, 192L, 224L, 256L)), .Names = ("VAR","VAL"), class = "data.frame", row.names = c(NA, -9L))
par(mar=c(1,3,1,5)+0.1,xpd=TRUE)
col.pal<-rgb(ddf$VAL,256-ddf$VAL,0,maxColorValue=256)
barplot(ddf$VAL,col=rgb(ddf$VAL,256-ddf$VAL,0,maxColorValue=256))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
color.legend(12,220,13,80,rev(ddf$VAL),rev(col.pal),gradient="y")
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART"
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
slowBart <- rnorm(length(trueY))
fastBART <- rnorm(length(trueY))
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
setwd("~/research/storm_surges/flood")
pdf("temp_plots.pdf")
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
slowBart <- rnorm(length(trueY))
setwd("~/research/storm_surges/flood")
pdf("temp_plots.pdf")
par(mfrow = c(2,3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
slowBART <- rnorm(length(trueY))
pdf("temp_plots.pdf")
par(mfrow = c(2,3), oma = c(0.1, 0.1, 0.1, 0.3))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
pdf("temp_plots.pdf")
par(mfrow = c(2,3), oma = c(0, 0, 0, 1))
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
dev.off()
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
axis(2,cex.axis=2)
par(cex.lab=2)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
pdf("temp_plots.pdf")
par(mfrow = c(2,3), oma = c(0, 0, 0, 1), cex.lab = 1.5)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
pdf("temp_plots.pdf")
par(mfrow = c(2,3), oma = c(0, 1, 0, 2), cex.lab = 1.5)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
pdf("temp_plots.pdf", width = 10)
par(mfrow = c(2,3), oma = c(0, 1, 0, 2), cex.lab = 1.5)
# All storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="All Storms", ylab = "Sketching",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="Slow-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, sketching
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastSketch), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="Fast-Moving Storms",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
# All storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - allBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="", ylab = "BART",
col = hcl.colors(12, "terrain", rev=TRUE))
# Slow storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - slowBART), no.X=100, no.Y=100, extend=T)$xyz.est
image(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE))
# Fast storms, BART
surf <-  mba.surf(cbind(coords[indexTest, 1:2], trueY - fastBART), no.X=100, no.Y=100, extend=T)$xyz.est
image.plot(surf, xaxs ="r", yaxs = "r", main="",
col = hcl.colors(12, "terrain", rev=TRUE),
legend.lab = "Residual (meters)", legend.cex = 0.75)
dev.off()
setwd("~/research/storm_surges/flood")
